
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Working with Dask - Shakudo Platform</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#working-with-dask" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Shakudo Platform" class="md-header__button md-logo" aria-label="Shakudo Platform" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shakudo Platform
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Working with Dask
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Shakudo Platform" class="md-nav__button md-logo" aria-label="Shakudo Platform" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Shakudo Platform
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="api.html" class="md-nav__link">
        Hyperplane API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="sandbox.html" class="md-nav__link">
        Demo/sandbox walkthrough
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="example_notebooks.html" class="md-nav__link">
        Example notebooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="tutorials.html" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="faq.html" class="md-nav__link">
        FAQ
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Using ✈️ Shakudo Hyperplane
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using ✈️ Shakudo Hyperplane" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Using ✈️ Shakudo Hyperplane
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="sessions.html" class="md-nav__link">
        Start a Jupyter instance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="create_pipeline.html" class="md-nav__link">
        Create a pipeline job
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="debug_jobs.html" class="md-nav__link">
        Debug a pipeline job
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="create_service.html" class="md-nav__link">
        Create a pipeline service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="image_jobtype_packages.html" class="md-nav__link">
        Images and jobTypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphql_queries.html" class="md-nav__link">
        Graphql query examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="dask_hyperplane.html" class="md-nav__link">
        Dask on Shakudo Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ray_hyperplane.html" class="md-nav__link">
        Ray on Shakudo Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="spark_hyperplane.html" class="md-nav__link">
        Spark on Shakudo Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="frontend_tools.html" class="md-nav__link">
        Frontend on Shakudo Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="nlp_hyperplane.html" class="md-nav__link">
        NLP on Shakudo Platform
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Advanced Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Advanced Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Dask
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Dask" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Dask
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Working with Dask
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="dask_concepts.html" class="md-nav__link md-nav__link--active">
        Working with Dask
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#collections" class="md-nav__link">
    Collections
  </a>
  
    <nav class="md-nav" aria-label="Collections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dask-bags" class="md-nav__link">
    dask bags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dask-dataframes" class="md-nav__link">
    Dask dataframes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operations" class="md-nav__link">
    Operations
  </a>
  
    <nav class="md-nav" aria-label="Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lazy-calculations" class="md-nav__link">
    Lazy calculations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repartitioning" class="md-nav__link">
    Repartitioning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split-out" class="md-nav__link">
    Split out
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheap-vs-expensive-computations" class="md-nav__link">
    Cheap vs. expensive computations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-types" class="md-nav__link">
    File types
  </a>
  
    <nav class="md-nav" aria-label="File types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parquet-files" class="md-nav__link">
    parquet files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avro-files" class="md-nav__link">
    avro files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#saving-to-cloud-storage" class="md-nav__link">
    Saving to cloud storage
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="examples.html" class="md-nav__link">
        Dask optimization examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="common_issues.html" class="md-nav__link">
        Common issues
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="rapids_on_hyperplane.html" class="md-nav__link">
        RAPIDS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="sas_on_hyperplane.html" class="md-nav__link">
        SAS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="r_on_hyperplane.html" class="md-nav__link">
        R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="mlflow_on_hyperplane.md" class="md-nav__link">
        MLFlow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="triton_serving.html" class="md-nav__link">
        Triton
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="crypto.html" class="md-nav__link">
        CCXT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="custom_secret.html" class="md-nav__link">
        Custom Secrets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="custom_images.html" class="md-nav__link">
        Custom Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pullrequest.html" class="md-nav__link">
        Jupyterlab Pullrequests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="jwt.html" class="md-nav__link">
        Trigger Jobs anywhere
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="hyperplane_gql_queries.html" class="md-nav__link">
        Advanced Graphql queries
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Shakudo Platform Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Shakudo Platform Tools" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Shakudo Platform Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ssh_connection.html" class="md-nav__link">
        Connect to VSCode Remote
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="about.html" class="md-nav__link">
        About Shakudo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#collections" class="md-nav__link">
    Collections
  </a>
  
    <nav class="md-nav" aria-label="Collections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dask-bags" class="md-nav__link">
    dask bags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dask-dataframes" class="md-nav__link">
    Dask dataframes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operations" class="md-nav__link">
    Operations
  </a>
  
    <nav class="md-nav" aria-label="Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lazy-calculations" class="md-nav__link">
    Lazy calculations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repartitioning" class="md-nav__link">
    Repartitioning
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split-out" class="md-nav__link">
    Split out
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheap-vs-expensive-computations" class="md-nav__link">
    Cheap vs. expensive computations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-types" class="md-nav__link">
    File types
  </a>
  
    <nav class="md-nav" aria-label="File types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parquet-files" class="md-nav__link">
    parquet files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avro-files" class="md-nav__link">
    avro files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#saving-to-cloud-storage" class="md-nav__link">
    Saving to cloud storage
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="working-with-dask">Working with Dask<a class="headerlink" href="#working-with-dask" title="Permanent link">&para;</a></h1>
<p>Let's explore some Dask concepts. In this section, we introduce dask bags and dataframes, as well as common file formats.</p>
<p>For full Dask documentation, check out <a href="https://docs.dask.org/en/latest/">https://docs.dask.org/en/</a></p>
<h2 id="collections">Collections<a class="headerlink" href="#collections" title="Permanent link">&para;</a></h2>
<p>Dask collections are useful for large datasets because they support delayed tasks. We will explore three types&mdash; Dask bags, Dask dataframes, and Dask arrays. </p>
<h3 id="dask-bags">dask bags<a class="headerlink" href="#dask-bags" title="Permanent link">&para;</a></h3>
<p>Dask bags (synonymous with multisets) are unordered collections of immutable objects. Below are some common operations:</p>
<p>Select records where:
<div class="highlight"><pre><span></span><code><span class="n">b</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">record</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;num_clicks&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> 
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="go">({&#39;id&#39;: &#39;01mz489cnkd&#39;,  </span>
<span class="go">  &#39;area&#39;: &#39;Aerial Alaska&#39;,  </span>
<span class="go">  &#39;num_clicks&#39;: 3,</span>
<span class="go">  &#39;info&#39;: {&#39;a_field&#39;: 0}},  </span>
<span class="go"> {&#39;id&#39;: &#39;25z48t9cfaf&#39;,  </span>
<span class="go">  &#39;area&#39;: &#39;Bustling Birktown&#39;,  </span>
<span class="go">  &#39;num_clicks&#39;: 5,</span>
<span class="go">  &#39;info&#39;: {&#39;a_field&#39;: 1}})  </span>
</code></pre></div>
<p>Select one field:
<div class="highlight"><pre><span></span><code><span class="n">b</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">record</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="go">(&#39;Aerial Alaska&#39;, &#39;Bustling Birktown&#39;)</span>
</code></pre></div>
<p>Aggregate the number of records in your bag:
<div class="highlight"><pre><span></span><code><span class="n">b</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="go">100000</span>
</code></pre></div>
<p>Note that the <code>.take(n)</code> function will return the first <strong>n</strong> records from the bag, only in the first partition.</p>
<p>For more info, see <a href="https://examples.dask.org/bag.html">https://examples.dask.org/bag.html</a></p>
<h3 id="dask-dataframes">Dask dataframes<a class="headerlink" href="#dask-dataframes" title="Permanent link">&para;</a></h3>
<p>Dask dataframes are collections of pandas dataframes. It can be used in cases where one pandas dataframe is too large to fit in memory and to speed up expensive computations by using multiple cores. </p>
<p>To read multiple csvs, use the * or a list of files. Each file will be read into a separate partition.</p>
<div class="highlight"><pre><span></span><code>import dask.dataframe as dd
df = dd.read_csv(&#39;2014-*.csv&#39;)
</code></pre></div>
<p>A common workflow is the following:</p>
<ol>
<li>Load large datasets from files</li>
<li>Filter to a subset of data</li>
<li>Shuffle data to get an intelligent index</li>
<li>Perform queries or aggregations using the indices</li>
</ol>
<p>For more information on Dask dataframes, see <a href="https://docs.dask.org/en/latest/dataframe.html">https://docs.dask.org/en/latest/dataframe.html</a>.</p>
<h2 id="operations">Operations<a class="headerlink" href="#operations" title="Permanent link">&para;</a></h2>
<h3 id="lazy-calculations">Lazy calculations<a class="headerlink" href="#lazy-calculations" title="Permanent link">&para;</a></h3>
<p>Dask operates with <strong>lazy</strong> collections, meaning operations on a collection are simply scheduled by the scheduler, but the actual calculation will not be triggered until explicitly called. At first, you will notice that dataframe operations or functions seem to happen almost instantaneously, but nothing will be calculated until one of the following is used:</p>
<ul>
<li>.persist()</li>
<li>.compute()</li>
<li>.load()</li>
</ul>
<p><code>.compute()</code> will trigger a computation on the Dask cluster without returning anything. You can use this if some of your functions include saving to a location.</p>
<p><code>.persist()</code> will trigger a computation on the Dask cluster and store the results in ram. Use this sparingly, only if you need to use an intermediate collection, or after a computationally expensive operation such as index, groupby, etc.</p>
<p><code>.load()</code> will trigger a computation on the Dask cluster when you are working with Dask xarrays.</p>
<p>For example, you can trigger all computations on your dataframe like the following:</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;file*.csv&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;col_a&#39;</span><span class="p">,</span> <span class="s1">&#39;col_b&#39;</span><span class="p">]]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">persist</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div>
<h3 id="repartitioning">Repartitioning<a class="headerlink" href="#repartitioning" title="Permanent link">&para;</a></h3>
<p>After a few computations, your Dask df may need to be repartitioned, due to the partition size-number tradeoff. Partitions that are too large will cause out of memory errors, while too many partitions will incure a larger overhead time for the schedule to process. See more on best practices at <a href="https://docs.dask.org/en/latest/dataframe-best-practices.html">https://docs.dask.org/en/latest/dataframe-best-practices.html</a>.</p>
<h3 id="split-out">Split out<a class="headerlink" href="#split-out" title="Permanent link">&para;</a></h3>
<p>Dataframe aggregation operations can get wuite slow. Try to use <code>split_out</code> in aggregation operationg like groupbys to spread the aggregation work.</p>
<h3 id="cheap-vs-expensive-computations">Cheap vs. expensive computations<a class="headerlink" href="#cheap-vs-expensive-computations" title="Permanent link">&para;</a></h3>
<p>Examples of fast and cheap computations:</p>
<ul>
<li>Element-wise ops (addition, multiplication)</li>
<li>Row-wise operations and filtering: <code>df[df.x &gt; 0]</code></li>
<li>Joining Dask dfs along indexed fields, or joining with a one-partition Dask df</li>
<li>Max, min, count, common aggregations (<code>df.groupby(df.x).y.max()</code>)</li>
<li>isin: <code>df[df.x.isin([1, 2, 3])]</code></li>
<li>drop_duplicates</li>
<li>groupby-apply on an index: <code>df.groupby(['idx', 'x']).apply(myfunc)</code></li>
</ul>
<p>Examples of slow and expensive computations (for this reason, it is often recommended to use persist your data after these steps for stability):</p>
<ul>
<li>setting an index: <code>df.set_index(df.x)</code></li>
<li>groupby-apply on non-index fields: <code>df.groupby(df.x).apply(myfunc)</code></li>
<li>joining two dataframes along non-index columns</li>
</ul>
<h2 id="file-types">File types<a class="headerlink" href="#file-types" title="Permanent link">&para;</a></h2>
<h3 id="parquet-files">parquet files<a class="headerlink" href="#parquet-files" title="Permanent link">&para;</a></h3>
<p>Parquet is a columnar storage format for Hadoop, which enables parallel reading and writing, and is most useful for efficiently filtering a subset of fields in a Dask df. </p>
<h3 id="avro-files">avro files<a class="headerlink" href="#avro-files" title="Permanent link">&para;</a></h3>
<p>Avro is a row-based storage format for Hadoop, which is most efficient if you intend to retrieve and use all fields or columns in the dataset. </p>
<h2 id="saving-to-cloud-storage">Saving to cloud storage<a class="headerlink" href="#saving-to-cloud-storage" title="Permanent link">&para;</a></h2>
<p>Remember that new workers are spun up when use <code>.initialize_cluster()</code>, and they are destroyed on <code>cluster.close()</code>. This means you should ensure your intermediate and output files are saved in a cloud storage location that can be accessed outside of each node. </p>
<p>This can be achieved through the following code example:</p>
<div class="highlight"><pre><span></span><code><span class="n">gcp_project</span> <span class="o">=</span> <span class="n">YOUR_GCP_PROJECT</span>
<span class="n">gcs_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">gcp_project</span><span class="p">)</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">gcs_client</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="n">bucket</span><span class="p">)</span>
<span class="n">blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="n">yourfile</span><span class="p">)</span>
<span class="n">blob</span><span class="o">.</span><span class="n">upload_from_string</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/x-www-form-urlencoded;charset=UTF-8&#39;</span><span class="p">)</span>
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="nlp_hyperplane.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: NLP on Shakudo Platform" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              NLP on Shakudo Platform
            </div>
          </div>
        </a>
      
      
        
        <a href="examples.html" class="md-footer__link md-footer__link--next" aria-label="Next: Dask optimization examples" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Dask optimization examples
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>